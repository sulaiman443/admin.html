<script>
    // --- نظام الحماية بكلمة مرور ---
    const ADMIN_PASSWORD = "05336720142014"; // قم بتغيير كلمة المرور هنا
    
    function checkAuth() {
        const pass = prompt("الرجاء إدخال كلمة مرور الإدارة:");
        if (pass !== ADMIN_PASSWORD) {
            alert("كلمة مرور خاطئة! سيتم توجيهك للصفحة الرئيسية.");
            window.location.href = "index.html";
        }
    }

    // استدعاء الحماية عند فتح الصفحة
    checkAuth();

    // --- بقية كود الإدارة السابق ---
    let matches = JSON.parse(localStorage.getItem('matches')) || [];

    function render() {
        const list = document.getElementById('admin-list');
        document.getElementById('count').innerText = `${matches.length} مباراة`;
        
        list.innerHTML = matches.map((m, i) => `
            <div class="match-card p-5 rounded-[1.5rem] flex flex-wrap md:flex-nowrap justify-between items-center gap-4">
                <div class="flex items-center gap-4 flex-1">
                    <div class="flex -space-x-2">
                        <img src="${m.h_logo || 'https://via.placeholder.com/40'}" class="w-10 h-10 rounded-full border-2 border-[#050810] bg-white/5 object-contain">
                        <img src="${m.a_logo || 'https://via.placeholder.com/40'}" class="w-10 h-10 rounded-full border-2 border-[#050810] bg-white/5 object-contain">
                    </div>
                    <div>
                        <h3 class="font-bold text-sm">${m.h} <span class="text-gray-600 mx-1">×</span> ${m.a}</h3>
                        <p class="text-[10px] text-blue-500 font-bold italic">${m.time} | ID: ${m.league}</p>
                    </div>
                </div>
                <div class="flex gap-2">
                    <button onclick="editMatch(${i})" class="w-10 h-10 rounded-xl bg-white/5 flex items-center justify-center text-blue-500 hover:bg-blue-600 hover:text-white transition"><i class="fas fa-edit"></i></button>
                    <button onclick="deleteMatch(${i})" class="w-10 h-10 rounded-xl bg-white/5 flex items-center justify-center text-red-500 hover:bg-red-600 hover:text-white transition"><i class="fas fa-trash-alt"></i></button>
                </div>
            </div>
        `).join('');
        if(matches.length === 0) list.innerHTML = `<div class="text-center py-20 text-gray-700 font-bold italic border-2 border-dashed border-white/5 rounded-[2rem]">لا توجد مباريات منشورة.. ابدأ بإضافة مباراة جديدة</div>`;
    }

    function handleMatch() {
        const index = parseInt(document.getElementById('edit-index').value);
        const data = {
            h: document.getElementById('h-name').value,
            h_logo: document.getElementById('h-logo').value,
            a: document.getElementById('a-name').value,
            a_logo: document.getElementById('a-logo').value,
            time: document.getElementById('m-time').value,
            stream: document.getElementById('m-stream').value,
            league: document.getElementById('m-league').value,
            id: Date.now()
        };

        if(!data.h || !data.a || !data.stream) return alert('برجاء إدخال أسماء الفرق ورابط البث');

        if(index === -1) matches.push(data);
        else matches[index] = data;

        localStorage.setItem('matches', JSON.stringify(matches));
        resetForm();
        render();
    }

    function editMatch(i) {
        const m = matches[i];
        document.getElementById('h-name').value = m.h;
        document.getElementById('h-logo').value = m.h_logo;
        document.getElementById('a-name').value = m.a;
        document.getElementById('a-logo').value = m.a_logo;
        document.getElementById('m-time').value = m.time;
        document.getElementById('m-stream').value = m.stream;
        document.getElementById('m-league').value = m.league;
        document.getElementById('edit-index').value = i;
        document.getElementById('submit-btn').innerText = "تحديث البيانات";
        document.getElementById('submit-btn').className = "w-full bg-orange-600 py-4 rounded-2xl font-black";
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function deleteMatch(i) {
        if(confirm('هل أنت متأكد من حذف هذه المباراة؟')) {
            matches.splice(i, 1);
            localStorage.setItem('matches', JSON.stringify(matches));
            render();
        }
    }

    function resetForm() {
        document.getElementById('edit-index').value = "-1";
        document.getElementById('submit-btn').innerText = "نشر المباراة الآن";
        document.getElementById('submit-btn').className = "w-full bg-blue-600 py-4 rounded-2xl font-black";
        ["h-name", "h-logo", "a-name", "a-logo", "m-time", "m-stream"].forEach(id => document.getElementById(id).value = "");
    }

    function clearAll() { if(confirm('سيتم مسح جميع المباريات، هل أنت متأكد؟')) { localStorage.removeItem('matches'); matches = []; render(); } }

    render();
</script>